using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Configuration;
using BusinessLogic;
<<<<<<< HEAD

=======
>>>>>>> 956f86d761af1e7d3c585964f94447c8cf198bda

namespace BikeAble.Client
{
    public partial class Livraison : System.Web.UI.Page
    {
        int id = 0;
        LivraisonFactory factory = new LivraisonFactory(ConfigurationManager.ConnectionStrings["cnn1"].ConnectionString);
        List<Livraison> clientLivraison;
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!this.IsPostBack)
            {
                GetId();
                if(id != 0)
                {
                    fillGrid();
                }
                else
                {
                    Response.Redirect("../Home.aspx");
                }
            }
        }

        private void fillGrid()
        {
            //clientLivraison = factory.GetAll(id);
            tblLivraison.DataSource = clientLivraison;
            tblLivraison.DataBind();
        }

        protected void tblLivraison_RowDataBound(object sender, GridViewRowEventArgs e)
        {

        }

        protected void tblLivraison_SelectedIndexChanged(object sender, EventArgs e)
        {

        }

        protected void tblLivraison_PageIndexChanged(object sender, EventArgs e)
        {

        }
        private void GetId()
        {
            int.TryParse(Request["id"], out id);
        }
    }
}

/*
 USE `prj-coursiervelo`;
DELIMITER $$
CREATE DEFINER=`1532876`@`%` TRIGGER `coli_setPrice` AFTER INSERT 
ON `colis` FOR EACH ROW

begin
	declare colis_size VARCHAR(6);
	declare livraison_distance FLOAT;
	declare multiplyerPrice FLOAT;
	declare newPrice FLOAT;

	set colis_size = new.size_colis;
	set livraison_distance = (SELECT distance_livraison FROM livraison where ID_livraison = new.idLivraison_colis);
	
	CASE colis_size
		WHEN 'Lettre' THEN set multiplyerPrice = 2.4;
		WHEN 'Petit' THEN set multiplyerPrice = 3.00;
		WHEN 'Moyen' THEN set multiplyerPrice = 4.00;
		WHEN 'Grand' THEN set multiplyerPrice = 5.00;
	END CASE;

	set newPrice = livraison_distance * multiplyerPrice;


	update colis set new.price_colis = newPrice where ID_colis = new.ID_colis;
end
     
     */
